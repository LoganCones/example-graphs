library(ggplot2)

# Create sample data
set.seed(123)
df <- data.frame(
  month = rep(month.abb, 2),
  category = rep(c("Category 1", "Category 2"), each = 12),
  value = rpois(24, 50)
)

# Create stacked bar chart
ggplot(df, aes(x = month, y = value, fill = category)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("#FFA500", "#00BFFF")) +
  xlab("Month") +
  ylab("Total Value") +
  ggtitle("Stacked Bar Chart with Total Value Line") +
  theme(plot.title = element_text(hjust = 0.5))

# Create line graph of total values
df_total <- aggregate(value ~ month, data = df, FUN = sum)

# Overlay line graph on top of stacked bar chart
ggplot() +
  # Stacked bar chart
  geom_bar(data = df, aes(x = month, y = value, fill = category), stat = "identity") +
  scale_fill_manual(values = c("#FFA500", "#00BFFF")) +
  xlab("Month") +
  ylab("Total Value") +
  ggtitle("Stacked Bar Chart with Total Value Line") +
  theme(plot.title = element_text(hjust = 0.5)) +
  # Total value line graph
  geom_line(data = df_total, aes(x = month, y = value), color = "black", size = 1)
